clear all
n = 3;
stage = 0;
h = 1/n;
dimM = 4*(n*n+3*stage);
G = zeros(dimM,1);
for i = 1:n
    G(4*i) = h + ((1-(i-1)/n)^2-(1-i/n)^2)/2;
    G(3+(i-1)*4*n) = h + ((1-(i-1)/n)^2-(1-i/n)^2)/2;
end
for i = 1:n
    G(4*n*(n-1)+4*i-2) = -((1-(i-1)/n)^2-(1-i/n)^2)/2;
    G(4*i*n-3) = -((1-(i-1)/n)^2-(1-i/n)^2)/2;
end
if stage ~= 0
    G(4*n*n-2) = 0;
    G(4*n*n-3) = 0;
for s = 1:stage
    G(4*(n*(n-1)+3*(s-1))+5) = -(h/(2^(s-1))^2-(h/(2^s))^2)/2;
    G(4*(n*(n-1)+3*(s-1))+10) = -(h/(2^(s-1))^2-(h/(2^s))^2)/2;
end
G(dimM-2) = -(h/(2^(stage-1))^2)/2;
G(dimM-3) = -(h/(2^(s-1))^2-(h/(2^s))^2)/2;
end
